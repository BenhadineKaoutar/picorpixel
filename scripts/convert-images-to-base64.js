// Script to convert images to base64 for embedding in the app
const fs = require('fs');
const path = require('path');

const publicDir = path.join(__dirname, '../src/client/public');
const outputFile = path.join(__dirname, '../src/server/utils/imageAssets.ts');

const imageFiles = [
  'sample-real-1.jpg',
  'sample-real-2.jpg',
  'sample-real-3.jpg',
  'sample-ai-1.jpg',
  'sample-ai-2.jpg'
];

console.log('Converting images to base64...\n');

let output = `// Image assets as base64 data URLs
// Auto-generated by scripts/convert-images-to-base64.js

export const imageAssets = {\n`;

for (const filename of imageFiles) {
  const filePath = path.join(publicDir, filename);
  
  if (!fs.existsSync(filePath)) {
    console.warn(`⚠️  Warning: ${filename} not found at ${filePath}`);
    output += `  '${filename}': '',\n`;
    continue;
  }
  
  const imageBuffer = fs.readFileSync(filePath);
  const base64 = imageBuffer.toString('base64');
  const sizeKB = (base64.length / 1024).toFixed(2);
  
  console.log(`✓ ${filename} (${sizeKB} KB)`);
  
  output += `  '${filename}': '${base64}',\n`;
}

output += `};

export function getImageDataUrl(filename: string): string {
  const base64 = imageAssets[filename as keyof typeof imageAssets];
  if (!base64) {
    console.warn(\`Image not found: \${filename}\`);
    return '';
  }
  return \`data:image/jpeg;base64,\${base64}\`;
}
`;

fs.writeFileSync(outputFile, output);

console.log(`\n✓ Base64 images written to ${outputFile}`);
console.log('\nYou can now use these images in your daily challenge!');
